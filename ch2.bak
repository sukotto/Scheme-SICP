#lang racket
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
; 2.1 Introduction to Data Abstraction
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;(define (make-rat n d) (cons n d))

; Exercise 2.1
(define (make-rat n d)
  (let ((g (gcd n d)))
    (cons (/ n g) (abs(/ d g)))))

(define (numer x) (car x))

(define (denom x) (cdr x))

(define (print-rat x)
  (newline)
  (display (numer x))
  (display "/")
  (display (denom x)))

(define one-half (make-rat 1 2))

(define one-third (make-rat 1 3))

; Exercise 2.2 Represent line segments in a plane
(define (make-point x y)
  (cons x y))

(define (x-point point)
  (car point))

(define (y-point point)
  (cdr point))

(define (make-segment start-point end-point)
  (cons start-point end-point))

(define (start-segment segment)
  (car segment))

(define (end-segment segment)
  (cdr segment))

(define (midpoint-segment segment)
  (let*((start (start-segment segment))
        (end (end-segment segment))
        (mid-x (/ (+ (x-point start)(x-point end))2))
        (mid-y (/ (+ (y-point start)(y-point end))2))
        (mid-point (make-point mid-x mid-y)))
    mid-point))

(define (print-point p)
  (newline)
  (display "(")
  (display (x-point p))
  (display ",")
  (display (y-point p))
  (display ")"))

; Exercise 2.3 Implement a representation for rectangles
;1st Representation
;(define (make-rectangle point width height)
;  (list point width height))
;
;(define (r-point rectangle)
;  (first rectangle))
;
;(define (r-width rectangle)
;  (second rectangle))
;
;(define (r-height rectangle)
;  (third rectangle))
;2nd Representation
(define (make-rectangle p1 p2)
  (let*((x1 (x-point p1))
       (y1 (y-point p1))
       (x2 (x-point p2))
       (y2 (y-point p2))
       (width (abs(- x2 x1)))
       (height(abs(- y2 y1))))
    (list p1 p2 width height)))

(define (r-width rectangle)
  (third rectangle))

(define (r-height rectangle)
  (fourth rectangle))


(define (r-perimeter rectangle)
  (let((w (r-width rectangle))
       (h (r-height rectangle)))
    (+ (* 2 w)(* 2 h))))

(define (r-area rectangle)
  (let((w (r-width rectangle))
       (h (r-height rectangle)))
    (* w h)))
         
;2.1.4 Interval Arithmetic
(define (add-interval x y)
  (make-interval (+ (lower-bound x) (lower-bound y))
                 (+ (upper-bound x) (upper-bound y))))

(define (mul-interval x y)
  (let ((p1 (* (lower-bound x) (lower-bound y)))
        (p2 (* (lower-bound x) (upper-bound y)))
        (p3 (* (upper-bound x) (lower-bound y)))
        (p4 (* (upper-bound x) (upper-bound y))))
    (make-interval (min p1 p2 p3 p4)
                   (max p1 p2 p3 p4))))

(define (div-interval x y)
  (mul-interval x 
                (make-interval (/ 1.0 (upper-bound y))
                               (/ 1.0 (lower-bound y)))))

;Exercise 2.7
(define (make-interval a b) (cons a b))

(define (lower-bound interval)
  (car interval))

(define (upper-bound interval)
  (cdr interval))

;Exercise 2.8
(define (sub-interval a b)
  (make-interval (- (lower-bound a)(upper-bound b))
                 (- (upper-bound a)(lower-bound b))))

(define (make-center-width c w)
  (make-interval (- c w) (+ c w)))
(define (center i)
  (/ (+ (lower-bound i) (upper-bound i)) 2))
(define (width i)
  (/ (- (upper-bound i) (lower-bound i)) 2))

; Exercise 2.12
(define (make-center-percent center percent)
  (let*((bound (* center (/ percent 100.0)))
        (lower (- center bound))
       (upper (+ center bound)))
    (make-interval lower upper)))

(define (percent interval)
  (let*((width (abs(- (center interval) 
                      (lower-bound interval))))
        (percent-value (/ (* width 100.0)
                          (center interval))))
    percent-value))
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
; 2.2 Hierarchical Data and the Closure Property
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
; 2.2.1 Representing Sequences
; Exercise 2.17.
(define (last-pair l)
  (if(null? (cdr l))
     l
     (last-pair (cdr l))))

; Exercise 2.18.
(define (reverse l)
  (define (aux l acc)
    (if(null? l)
       acc
       (aux (cdr l)(cons(car l)acc))))
  (aux l '()))

; Exercise 2.20.
(define (same-parity x . xs)
  (cond[(even? x)
     (cons x (filter even? xs))]
     [(odd? x)
      (cons x (filter odd? xs))]
     [else "Error: wrong input"]))

; Exercise 2.21.
;(define (square-list items)
;   (if (null? items)
;       null
;       (cons (* (car items)(car items)) 
;             (square-list (cdr items)))))

(define (square-list items)
   (map (Î»(x)(* x x)) items))

; Exercise 2.23.
(define (for-each f xs)
  (if(null? xs) 
     #t
     (and (f (car xs))
              (for-each f (cdr xs)))))

;2.2.2 Hierarchical Structures
(define (count-leaves x)
  (cond ((null? x) 0)  
        ((not (pair? x)) 1)
        (else (+ (count-leaves (car x))
                 (count-leaves (cdr x))))))

;2.28.
(define(fringe x)
  (cond[(null? x)null]
       [(not(pair? x))x]
       [(cons (fringe (first x))
              (fringe (rest x)))]))

